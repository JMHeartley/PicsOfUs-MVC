@model List<PicsOfUs.Models.Photo>
@{
    ViewBag.Title = "Index";
}

@Html.ActionLink("Add Pic", "New", null, new { @class = "btn btn-primary my-3" })

@Html.ActionLink("Add Member", "New", "Members", null, new { @class = "btn btn-primary my-3" })

@if (!Model.Any())
{
    <h4>There are no photos to display...</h4>
}
else
{
    <div class="row no-gutters justify-content-center">
        <div class="px-5 my-3 ml-md-5 text-center">
            <h4>Date</h4>
            <a href="#" class="btn btn-primary">Add date</a>
        </div>
        <div class="px-5 my-3 ml-md-5 text-center">
            <h4>People</h4>
            <a href="#" class="btn btn-primary">Add person</a>
        </div>
    </div>
    <div>
        <h4 class="text-md-left text-center ml-md-5 pl-md-5">Results</h4>
        <div class="d-flex flex-wrap justify-content-around py-3 px-4" id="results-body">
            @*@foreach (var photo in Model)*@
            @for (int i = 0; i < Model.Count(); i++)
            {
                <div class="card m-2">
                    <div class="card-img-wrap d-flex justify-content-center align-content-center">
                        <img src="@Model[i].Url" alt="@Model[i].Caption">
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">@Model[i].Caption</h5>
                        <h6 class="card-subtitle text-muted mb-3">taken on @Model[i].CaptureDateDisplay</h6>
                        @Html.ActionLink("Edit", "Edit", new {id = Model[i].Id}, new {@class = "btn btn-secondary card-link"})
                        @*@Html.ActionLink("Details", "Details", new { id = photo.Id }, new { @class = "btn btn-primary card-link" })*@
                        <button class="btn btn-primary js-delete" data-photo-id="@Model[i].Id">Delete</button>
                        <button class="btn btn-primary trigger" data-result-id="@i" data-photo-id="@Model[i].Id">open lightbox</button>
                    </div>
                </div>
            }
        </div>
    </div>

    <div class="row no-gutters hidden" id="lightbox-container">
        <div id="lightbox" class="col-12 col-lg-10 row no-gutters red-border">
            <i class="fas fa-times-circle lightbox-closer" aria-hidden="true" id="lightbox-closer-x"></i>
            <div class="col-12 col-lg-8 d-flex justify-content-center green-border" id="lightbox-main">
                <div id="member-details" class="hidden">
                    member details
                    <p id="back">back</p>
                </div>
                <div class="green-border" id="left-arrow">
                    <i class="fas fa-arrow-left" aria-hidden="true"></i>
                </div>
                <img src="https://d2gg9evh47fn9z.cloudfront.net/800px_COLOURBOX2301800.jpg" alt="pic" id="lightbox-pic">
                <div class="green-border" id="right-arrow">
                    <i class="fas fa-arrow-right" aria-hidden="true"></i>
                </div>
            </div>
            <div class="lightbox-closer d-flex justify-content-center align-items-center mobile-nav-button hidden red-border" id="lightbox-closer-button">
                <h4 class="font-weight-normal">Back</h4>
            </div>
            <div id="lightbox-details" class="col-12 col-lg-4 pt-3 px-3 d-flex blue-border">
                <h3 id="caption" class="font-weight-bolder">Caption!</h3>
                <p id="capture-date" class="font-weight-lighter">Capture date</p>
                <div class="d-flex align-items-center" id="love-pic" data-is-loved="false">
                    <i class="far fa-heart mx-2" aria-hidden="true"></i>
                    <span class="font-weight-normal">Love Pic</span>
                </div>
                <div id="pic-subjects" class="my-3 p-1 d-flex red-border">
                    <!-- this is where the mini profiles go! -->
                </div>
                <!-- 
                <div id="comments" class="mb-3 blue-border">
                    <div class="make-long">
                        this is where the comments go!
                    </div>
                </div> 
                -->
            </div>
        </div>
    </div>
}

@section scripts
{
    <script>
        function ShowDetails(photoId) {
            window.location.href = "/Browse/Details/" + photoId;
        }
        $(document).ready(function () {

            $("#results-body").on("click", "js-delete", function () {
                var button = $(this);

                bootbox.confirm("Are you sure you want to delete this pic?", function (result) {

                    if (result) {
                        $.ajax({
                            url: "/api/photos/" + button.attr("data-photo-id"),
                            method: "DELETE",
                            success: function () {
                                button.parent("div").parent("div .card").remove();
                                console.log("photo deleted!");
                            }
                        });
                    }
                });
            });
        });
    </script>
}